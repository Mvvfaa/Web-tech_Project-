<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>All Candle Categories</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-cream': '#f7f5f3',
            'brand-light': '#fefcfa',
            'brand-brown': '#8b7355',
            'brand-sage': '#6b8e5a',
            'brand-sage-dark': '#5a7a4a',
            'brand-pink': '#d4a5a5',
            'brand-peach': '#f4a5a5',
            'brand-gray': '#2c2c2c',
            'brand-light-gray': '#5a5a5a',
            'brand-section': '#f2f0ed'
          },
          fontFamily: {
            'serif': ['Georgia', 'serif']
          }
        }
      }
    }
  </script>

  <style>
    .group:hover ul,
    .group:focus-within ul {
      opacity: 1 !important;
      pointer-events: auto !important;
    }
  </style>

</head>
<body class="font-serif leading-relaxed text-brand-gray bg-brand-cream">

  <!-- Header -->
  <header class="bg-brand-light shadow-lg sticky top-0 z-50" style="box-shadow: 0 2px 10px rgba(139, 115, 85, 0.1);">
    <nav class="max-w-7xl mx-auto px-4 md:px-6 py-4 flex justify-between items-center">
      <a href="index.html" class="flex items-center space-x-2 md:space-x-3">
        <img src="images\logo.jpg" 
        alt="The Candle Co Logo" class="w-8 h-8 md:w-10 md:h-10 rounded-full object-cover">
        <span class="hidden sm:inline-block text-lg md:text-3xl font-bold text-brand-brown">The Candle Co</span>
      </a>
      <!-- Navigation -->
      <ul class="hidden md:flex space-x-8 items-center relative">
        <li><a href="index.html#home" class="hover:text-brand-sage transition">Home</a></li>
        <li><a href="index.html#story" class="hover:text-brand-sage transition">Our Story</a></li>
        <li><a href="index.html#products" class="hover:text-brand-sage transition">Products</a></li>
        <li class="relative group">
          <a href="#categories" class="hover:text-brand-sage transition flex items-center">
            Categories
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
          </a>
          <!-- Dropdown menu -->
          <ul class="absolute left-0 mt-2 w-52 bg-white rounded-lg shadow-lg border border-gray-100 opacity-0 group-hover:opacity-100 group-hover:pointer-events-auto pointer-events-none transition-opacity duration-200 z-50">
            <li>
              <a href="all-products.html?category=tin" class="block px-5 py-3 text-brand-gray hover:bg-brand-sage hover:text-white transition rounded-t-lg">Silver Tin Candles</a>
            </li>
            <li>
              <a href="all-products.html?category=glass" class="block px-5 py-3 text-brand-gray hover:bg-brand-sage hover:text-white transition">Glass Jar Candles</a>
            </li>
            <li>
              <a href="all-products.html?category=frame" class="block px-5 py-3 text-brand-gray hover:bg-brand-sage hover:text-white transition">Frames</a>
            </li>
            <li>
              <a href="all-products.html?category=amber" class="block px-5 py-3 text-xs text-brand-gray hover:bg-brand-sage hover:text-white transition rounded-t-lg">Amber Jar</a>
            </li>
            <li>
              <a href="all-products.html" class="block px-5 py-3 text-brand-gray hover:bg-brand-sage hover:text-white transition rounded-b-lg">All Products</a>
            </li>
          </ul>
        </li>
        <li><a href="#contact" class="hover:text-brand-sage transition">Contact</a></li>
      </ul>

      <!--Essential Items -->
      <ul class="flex md:hidden space-x-4 items-center text-sm">
        <li><a href="index.html#home" class="hover:text-brand-sage transition">Home</a></li>
        <li class="relative group">
          <a href="#categories" class="hover:text-brand-sage transition flex items-center">
            Categories
            <svg class="ml-1 w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
          </a>
          <!-- Dropdown menu -->
          <ul class="absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border border-gray-100 opacity-0 group-hover:opacity-100 group-hover:pointer-events-auto pointer-events-none transition-opacity duration-200 z-50">
            <li>
              <a href="all-products.html?category=tin" class="block px-4 py-2 text-xs text-brand-gray hover:bg-brand-sage hover:text-white transition rounded-t-lg">Silver Tin</a>
            </li>
            <li>
              <a href="all-products.html?category=glass" class="block px-4 py-2 text-xs text-brand-gray hover:bg-brand-sage hover:text-white transition">Glass Jar</a>
            </li>
            <li>
              <a href="all-products.html?category=frame" class="block px-4 py-2 text-xs text-brand-gray hover:bg-brand-sage hover:text-white transition">Frames</a>
            </li>
            <li>
              <a href="all-products.html?category=amber" class="block px-4 py-2 text-xs text-brand-gray hover:bg-brand-sage hover:text-white transition">Amber Jar</a>
            </li>        
            <li>
              <a href="all-products.html" class="block px-4 py-2 text-xs text-brand-gray hover:bg-brand-sage hover:text-white transition rounded-b-lg">All</a>
            </li>
          </ul>
        </li>
        <li><a href="#contact" class="hover:text-brand-sage transition">Contact</a></li>
      </ul>

      <!-- Icons -->
      <div class="flex items-center space-x-4 md:space-x-6">
        <!-- Profile Icon -->
        <a href="login.html" aria-label="Profile" class="text-brand-sage hover:text-brand-brown transition">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 md:w-7 md:h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14c-4.418 0-8 1.79-8 4v2h16v-2c0-2.21-3.582-4-8-4z" />
          </svg>
        </a>
        <!-- Cart Icon -->
        <a href="cart.html" aria-label="Cart" class="text-brand-sage hover:text-brand-brown transition relative">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 md:w-7 md:h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.35 2.7A1 1 0 007 17h10a1 1 0 00.95-.68L21 9M7 13V6a1 1 0 011-1h5a1 1 0 011 1v7" />
          </svg>
         <span id="cart-count" class="absolute -top-2 -right-2 bg-brand-peach text-brand-gray text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center">0</span>
        </a>
      </div>
    </nav>
  </header>

  <!-- Main Content -->
<section id="products" class="py-20 px-8 max-w-7xl mx-auto">
  <h2 class="text-center text-4xl font-bold mb-12 text-brand-brown" data-aos="fade-up">
    Browse Products
  </h2>
  
  <!-- Added browse, filter, and sort controls -->
  <div class="mb-10 bg-white rounded-2xl shadow-lg p-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      
      <!-- Search/Browse -->
      <div>
        <label for="searchInput" class="block text-sm font-semibold text-brand-brown mb-2">Search Products</label>
        <input 
          type="text" 
          id="searchInput" 
          placeholder="Search by name..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-sage"
        >
      </div>

      <!-- Filter by Category -->
      <div>
        <label for="categoryFilter" class="block text-sm font-semibold text-brand-brown mb-2">Filter by Category</label>
        <select 
          id="categoryFilter"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-sage"
        >
          <option value="all">All Categories</option>
          <option value="tin">Silver Tin Candles</option>
          <option value="glass">Glass Jar Candles</option>
          <option value="frame">Frames</option>
          <option value="ramadan">Ramadan Collection</option>
          <option value="valentine">Valentine's Collection</option>
          <option value="amber">Amber Jar Candles</option>
        </select>
      </div>

      <!-- Sort -->
      <div>
        <label for="sortSelect" class="block text-sm font-semibold text-brand-brown mb-2">Sort By</label>
        <select 
          id="sortSelect"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-sage"
        >
          <option value="default">Default</option>
          <option value="name-asc">Name (A-Z)</option>
          <option value="name-desc">Name (Z-A)</option>
          <option value="price-asc">Price (Low to High)</option>
          <option value="price-desc">Price (High to Low)</option>
        </select>
      </div>

    </div>
  </div>

  <div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
    <!-- Products will be loaded here by JavaScript -->
  </div>
</section>

<script>
  let allProducts = [];

  // Load products from JSON
  fetch('assets/data/products.json')
    .then(response => response.json())
    .then(data => {
      allProducts = data.products;
      renderProducts(allProducts);
      applyURLFilter();
    })
    .catch(error => console.error('Error loading products:', error));

  function renderProducts(products) {
    const productsGrid = document.getElementById('productsGrid');
    productsGrid.innerHTML = '';

    if (products.length === 0) {
      productsGrid.innerHTML = '<div class="col-span-full text-center py-20"><p class="text-2xl text-brand-light-gray">No products found.</p></div>';
      return;
    }

    products.forEach((product, index) => {
      const card = document.createElement('div');
      card.className = 'product-card bg-white rounded-2xl shadow-lg overflow-hidden hover:scale-105 transition duration-500';
      card.setAttribute('data-category', product.category);
      card.setAttribute('data-name', product.name);
      card.setAttribute('data-price', product.price.replace(',', ''));
      card.setAttribute('data-theme', product.theme);
      card.setAttribute('data-aos', 'zoom-in');
      card.setAttribute('data-aos-delay', (index * 100) % 500);

      card.innerHTML = `
        <img src="${product.image}" class="w-full h-64 object-cover">
        <div class="p-6 text-center">
          <h3 class="text-xl font-bold">${product.displayName}</h3>
          <p class="text-brand-brown font-semibold mb-2">PKR ${product.price}</p>
          <p class="text-brand-light-gray mb-4">${product.description}</p>
          <button onclick="goToDetails('${product.detailsPage}?img=${product.image.split('/')[1]}&theme=${product.theme}')" class="px-6 py-2 bg-brand-sage text-white font-bold rounded-full hover:bg-brand-sage-dark transition">
            View Details
          </button>
        </div>
      `;

      productsGrid.appendChild(card);
    });
  }

  const searchInput = document.getElementById('searchInput');
  const categoryFilter = document.getElementById('categoryFilter');
  const sortSelect = document.getElementById('sortSelect');

  function filterAndSort() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedCategory = categoryFilter.value;
    const sortOption = sortSelect.value;

    let filtered = allProducts.filter(product => {
      const matchesSearch = product.name.toLowerCase().includes(searchTerm) || product.displayName.toLowerCase().includes(searchTerm);
      const matchesCategory = selectedCategory === 'all' || product.category === selectedCategory;
      return matchesSearch && matchesCategory;
    });

    if (sortOption === 'name-asc') {
      filtered.sort((a, b) => a.displayName.localeCompare(b.displayName));
    } else if (sortOption === 'name-desc') {
      filtered.sort((a, b) => b.displayName.localeCompare(a.displayName));
    } else if (sortOption === 'price-asc') {
      filtered.sort((a, b) => parseInt(a.price.replace(',', '')) - parseInt(b.price.replace(',', '')));
    } else if (sortOption === 'price-desc') {
      filtered.sort((a, b) => parseInt(b.price.replace(',', '')) - parseInt(a.price.replace(',', '')));
    }

    renderProducts(filtered);
  }

  searchInput.addEventListener('input', filterAndSort);
  categoryFilter.addEventListener('change', filterAndSort);
  sortSelect.addEventListener('change', filterAndSort);

  function applyURLFilter() {
    const urlParams = new URLSearchParams(window.location.search);
    const categoryParam = urlParams.get('category');
    if (categoryParam) {
      categoryFilter.value = categoryParam;
      filterAndSort();
    }
  }
</script>

  <!-- Quantity and Add to Cart Script -->
<script>
    (function () {
      const dec = document.getElementById('qty-decrease');
      const inc = document.getElementById('qty-increase');
      const input = document.getElementById('qty-input');
      const addBtn = document.getElementById('add-to-cart');
      const MIN = 1;
      const MAX = 99;

      function setQty(n) {
        let v = Number(n) || MIN;
        v = Math.max(MIN, Math.min(MAX, Math.floor(v)));
        input.value = v;
      }

      if (dec && inc && input) {
        dec.addEventListener('click', () => setQty(Number(input.value) - 1));
        inc.addEventListener('click', () => setQty(Number(input.value) + 1));

        [dec, inc].forEach(btn => {
          btn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              btn.click();
            }
          });
        });
      }

      addBtn?.addEventListener('click', () => {
        const qty = Number(document.getElementById('qty-input')?.value) || 1;
        
        // Get product info from data attributes
        const productName = document.querySelector('[data-name]')?.getAttribute('data-name') || 'Product';
        const productPrice = document.querySelector('[data-price]')?.getAttribute('data-price') || 'PKR 0';
        const productTheme = document.querySelector('[data-theme]')?.getAttribute('data-theme') || 'Classic';
        
        // Get selected size/scent
        const selectedSize = document.querySelector('input[name="scent"]:checked')?.value || 'Not selected';
        
        // Get product image
        const productImage = document.getElementById('product-image')?.src || '';
        
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const cartItem = {
          name: productName,
          price: productPrice,
          theme: productTheme,
          qty: qty,
          size: selectedSize,
          image: productImage
        };
        
        // Match by name AND size AND theme (different themes = different cart items)
        const existingItem = cart.find(item => 
          item.name === productName && 
          item.size === selectedSize && 
          item.theme === productTheme
        );
        if (existingItem) {
          existingItem.qty += qty;
        } else {
          cart.push(cartItem);
        }
        
        localStorage.setItem('cart', JSON.stringify(cart));
        
        const badge = document.getElementById('cart-count');
        if (badge) {
          const count = cart.reduce((sum, item) => sum + item.qty, 0);
          badge.textContent = count;
        }
        
        alert('Added ' + qty + ' ' + productName + ' (' + productTheme + ' - ' + selectedSize + ') to cart.');
      });
    })();
  </script>

<script src="assets/js/details-image.js"></script>

  <!-- Footer -->
  <footer>
    <div class="bg-brand-gray text-white py-10 shadow-lg">
      <div class="container mx-auto text-center">
        <h2 id="contact" class="text-4xl font-bold mb-6 text-brand-brown">Get in Touch</h2>
        <p class="mb-2">üìû +92 308 4449344</p>
        <p class="mb-4">üìç Sector C, Askari 11, Lahore, Pakistan</p>
        <a href="https://www.instagram.com/thecandleco.pk_/" target="_blank" class="inline-block mt-2">
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-8 h-8 hover:text-pink-400 transition duration-300">
            <path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2Zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5a4.25 4.25 0 0 0 4.25-4.25v-8.5A4.25 4.25 0 0 0 16.25 3.5h-8.5ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 1.5a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7ZM17.5 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/>
          </svg>
        </a>
      </div>
    </div>
    <div class="bg-brand-brown text-white py-6">
      <div class="container mx-auto flex items-center justify-center">
        <p class="text-sm">&copy; 2025 CandleCo. All rights reserved.</p>
      </div>
    </div>
  </footer>

    <script>
    (function () {
      function updateCartBadge() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const count = cart.reduce((sum, item) => sum + item.qty, 0);
        const badge = document.getElementById('cart-count');
        if (badge) badge.textContent = count;
      }
      updateCartBadge();
      window.addEventListener('storage', updateCartBadge);
    })();

    function goToDetails(url) {
      window.location.href = url;
    }
  </script>

</body>
</html>
